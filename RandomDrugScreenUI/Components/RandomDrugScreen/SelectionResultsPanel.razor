@* Selection Results Display Component *@
@if (SelectedCandidates != null && SelectedCandidates.Any())
{
  <div class="row mb-3">
        <div class="col-md-12">
      <div class="card border-success">
       <div class="card-header bg-success text-white">
       <h5 class="mb-0">
              <span class="oi oi-check"></span> 
            Selection Results - @SelectedCandidates.Count Candidate(s) Selected
     </h5>
         </div>
    <div class="card-body">
 <div class="alert alert-success">
     <strong>Success!</strong> @SelectedCandidates.Count candidate(s) have been randomly selected and their test dates have been updated.
</div>

   <div class="table-responsive">
   <table class="table table-striped">
         <thead>
        <tr>
      <th>#</th>
        <th>Name</th>
    <th>Shift</th>
    <th>Previous Test Date</th>
          <th>New Test Date</th>
        </tr>
      </thead>
     <tbody>
 @for (int i = 0; i < SelectedCandidates.Count; i++)
     {
        var candidate = SelectedCandidates[i];
       <tr>
  <td>@(i + 1)</td>
           <td><strong>@candidate.Name</strong></td>
<td>@(string.IsNullOrEmpty(candidate.Shift) ? "-" : candidate.Shift)</td>
     <td>@(candidate.TestDate.HasValue && candidate.TestDate.Value < DateTime.Now.Date ? candidate.TestDate.Value.ToShortDateString() : "Never")</td>
  <td><span class="badge bg-success">@DateTime.Now.ToShortDateString()</span></td>
     </tr>
       }
    </tbody>
         </table>
      </div>

 <div class="d-flex gap-2">
    <button class="btn btn-primary" @onclick="HandleExport">
             <span class="oi oi-data-transfer-download"></span> Export to CSV
         </button>
      <button class="btn btn-secondary" @onclick="HandleClear">
       <span class="oi oi-x"></span> Clear Results
          </button>
        </div>
        </div>
   </div>
  </div>
    </div>
}

@code {
    [Parameter] public List<RandomDrugScreenPerson>? SelectedCandidates { get; set; }
    [Parameter] public EventCallback OnExport { get; set; }
    [Parameter] public EventCallback OnClear { get; set; }

    private async Task HandleExport()
    {
        await OnExport.InvokeAsync();
    }

    private async Task HandleClear()
    {
  await OnClear.InvokeAsync();
    }
}
